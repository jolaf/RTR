
3D Objects Ray Tracing Renderer
Copyright (c) 1996 by VMZ SoftSystems, Inc.
Beta testing version

Уважаемые Алексей Викторович и Евгений Викторович !

Спешу сразу заметить, что данная программа НЕ работает в Real-Time !!!
Она  поддерживает  два режима - рендеринга и показа,  активируемые от-
дельно.  Базовым алгоритмом является трассировка  лучей.  К  программе
прилагается набор пре-рендеренных фильмов,  ибо расчет фильма занимает
от четырех часов на 386DX-40 до 17 минут на Pentium-100. Программа мо-
жет  работать  в двух видеорежимах - стандартный VGA 13h 320x200x256 и
VESA 10Fh 320x200x16.8M TrueColor.  К сожалению,  моя машина второй из
них  не  поддерживает,  поэтому  отладка его производилась "вслепую" с
лишь редким выходом на соответствующую машину. Рендеринг окончательных
фильмов  производился  в  "последний момент" после некоторых финальных
исправлений без возможности проверки и  существует  маленькая  вероят-
ность, что в VESA режиме программа просто не будет работать, но в этом
случае все можно проделать и в VGA где для  достижения  хоть  какой-то
плавности  цветовых переходов применена палитра оттенков серого цвета.
В TrueColor все смотрится гораздо лучше. В программе реализован расчет
трехмерных объектов ( плоскостей и тетраэдров ),  причем тетраэдры пе-
ресекаются лучом по методу  пересечения  подпространств.  Используется
модель освещения точечным источником с учетом угла падения луча.  Реа-
лизовано падение тени от произвольного объекта на произвольный объект,
но рассеивание света не отслеживается, и вся часть объекта, находящая-
ся в тени, имеет одинаковый цвет. В принципе планировалась организация
полупрозрачных граней, она даже была написана, но на отладку просто не
хватило времени ( эх, еще бы недельку ... ).

Требования к запуску следующие: процессор 386 или выше, около мегабай-
та  свободной  XMS памяти,  видео плата VGA,  хотя НУ ОЧЕНЬ ЖЕЛАТЕЛЬНА
плата с 24-битным DAC и 512KB видеопамяти, поддерживающая выше указан-
ный VESA-режим. При работе программы на просмотр рекомендуется загруз-
ка SmartDrive или другого дискового кэша с целью прекращения  подкачки
с диска на каждом кадре,  причем объем кэша рекомендуется большим, чем
размер просматриваемых фильмов.

Программа может производить рендеринг как на экран так и в память, что
делает возможным расчет фильма на станции, не поддерживающей требуемый
видеорежим.  Для показа полученного фильма искомая видеокарта  конечно
уже требуется. По умолчанию программа при рендеринге слегка ( примерно
вдвое ) архивирует получаемый фильм по алгоритму RLE  и  разархивирует
его  при  показе.  При этом размер получаемого кадра равен примерно 35
килобайт для VGA и примерно 80 килобайт для TrueColor. Этот режим мож-
но отключить,  но это только увеличит объем файла, почти не повлияв на
скорость.  Объем неархивированного кадра чуть меньше 64  килобайт  для
VGA и чуть меньше 192 килобайт для TrueColor. Конкретный фильм "зашит"
в код программы и содержит 52 кадра,  объем  неархивированного  фильма
равен 3,328,016 байт для VGA и 9,984,016 байт для TrueColor. Архивиро-
ванный фильм занимает соответственно 1,572,682  и  4,059,003  байт.  К
программе  прилагаются  готовые  архивированные  фильмы  как  для  VGA
( VGAFILM.SHT ), так и для TrueColor ( VESAFILM.SHT ). Так же прилага-
ются однокадровые картинки первых кадров этих же фильмов ( VGASHOT.SHT
и VESASHOT.SHT ).  Все эти файлы могут быть  получены  запуском  самой
программы. К сожалению, последняя ошибка ( были перепутаны R и B байты
в видеопамяти TrueColor ) была выявлена уже после создания прилагаемых
фильмов и перестроен был только файл с первым кадром, поэтому цветовая
гамма в нем будет отличаться от видимой в фильме.  Как уже отмечалось,
работа  в режиме TrueColor не гарантирована,  но все же попробуйте ис-
пользовать именно этот режим - красивее. При показе программа пытается
поставить режим,  указанный в файле,  а при рендеринге,  если режим не
указан явно ( чего требует рендеринг в память  ),  пытается  поставить
вначале TrueColor, а при ошибке - VGA.

Для быстрого  просмотра  используйте  прилагаемые BAT-файлы с именами,
аналогичными именам соответствующих SHT-файлов.  Информация  о  ключах
командной строки находится в файле APPLICAT.DOC,  а также выдается при
запуске самой программы ( RTR.EXE ) без  параметров.  В  вышеуказанном
файле указаны и некоторые параметры всего проекта в целом. Список фай-
лов с их краткими описаниями находится в файле RTR_FILE.LST .

Краткое описание "сюжета": "события" буквально "разворачиваются" внут-
ри параллелепипеда со срезанными углами. Дальняя его стена параллельна
экрану и находится от него на расстоянии три четверти  ширины  экрана.
Боковые  стены,  а  также "пол" и "потолок" находятся друг от друга на
расстоянии ширины экрана и перпендикулярны ему.  В центре находится НЕ
икосаэдр,  а его подобие,  собранное из тетраэдров ( ибо точный расчет
показал,  что собрать правильный икосаэдр из двадцати тетраэдров с об-
щей вершиной невозможно, а жаль ). Точечный источник света находится у
правой стены. Далее, в течение фильма, источник совершает поворот вок-
руг "икосаэдра" по эллипсу { cos, sin, 0.7 * sin } вокруг вертикальной
оси против часовой стрелки,  а сам  "икосаэдр"  поворачивается  дважды
вокруг той-же оси по часовой стрелке,  причем на второй и третьей чет-
вертях этого вращения составляющие его тетраэдры разлетаются в стороны
и собираются опять вместе.  После всего этого процесс повторяется зер-
кально ( Back-and-Forth ) и т.д.

Далее следует описание работы с программой:

В режиме RENDERING:
-------------------
Для запуска рендеринга главной программе ( RTR.EXE ) передайте  в  ко-
мандной строке следующие параметры:  во-первых,  команду `RENDER', или
просто букву `R' ( регистр не важен ). Во-вторых, для подавления боль-
шей  части  текстового  вывода  можно указать опцию `Quiet' или просто
`Q'.  Далее укажите имя файла, куда будет записан фильм. Потом укажите
необходимые ключи.  Ключи могут отделяться любым из символов `/', `\',
`-' или `+',  могут разделяться или нет пробелами и  вообще  группиро-
ваться под одним разделителем. Все следующие примеры эквивалентны: "/m
-s +n",  "/m/n/s",  "/nsm".  Полный список ключей выдается при запуске
без параметров,  а также находится в файле APPLICAT.DOC. Приведу неко-
торые комментарии: если фильм состоит, допустим, из четырех кадров, то
его  просмотр  будет  выглядеть:  в  режиме  Cycling  (  ключ  `c' ) :
123412341234...  ,  в  режиме  Back-and-Forth   (   ключ   `t'   )   :
1234321234321..., в режиме Ping-Pong ( ключ `p' ) : 123413212341321...
Режим Cycling,  а также направление вперед установлены  по  умолчанию.
Режим,  а также направление заданные при рендеринге, и будут использо-
ваться по умолчанию при показе.  Эти параметры никак не влияют на  сам
фильм. По умолчанию ( ключ `a' ) программа пытается выбрать для ренде-
ринга более мощный режим,  а при ошибке пытается поставить VGA, однако
ей  можно  явно указать,  какой режим использовать ( ключи `v' и `s').
При указании рендеринга в память ( ключ `m' ) один из этих ключей ДОЛ-
ЖЕН быть использован. По умолчанию ( ключ `r' ) система производит RLE
кодирование построенных кадров,  но при желании это можно  отменить  (
ключ  `n' ).  Для определения параметров готового фильма запустите его
на просмотр и завершите его клавишей ESC: вы увидите выведенные до по-
каза  параметры.  Они же выдаются перед началом рендеринга.  При самом
рендеринге вы увидите:  при работе в память - номер текущего рассчиты-
ваемого кадра ( Shot ) и текущей строки ( Line ),  при работе на экран
в правом нижнем углу показывается номер текущего рассчитываемого  кад-
ра.  Текущая строка и так в этом случае видна. Для прерывания построе-
ния нажмите клавишу ESC: рендеринг прервется в конце ближайшей строки,
в  файл будут помещены лишь полностью отрендеренные кадры ( то есть не
включая тот,  на котором произошло прерывание ), и их число вы увидите
в диагностике "Shots written".  Такой неполный фильм ( он может состо-
ять и из одного кадра ) вполне можно посмотреть. Если рендеринг преры-
вается на первом же кадре, то target-файл уничтожается.

В режиме SHOWING:
------------------
Для просмотра фильма главной программе ( RTR.EXE ) передайте в команд-
ной строке команду `SHOW' или просто букву `S'.  Все, что касается оп-
ции `Quiet' и ключей, аналогично режиму RENDERING. Естественно, указы-
вается  имя файла для показа.  Ключами здесь можно изменить лишь режим
показа ( Cycling и т.д. ) и направление. Как уже указывалось, рекомен-
дуется  наличие дискового кэша.  При просмотре можно использовать "се-
рые" клавиши `+' и `-' для изменения скорости показа,  которой имеется
десять градаций ( паузы между кадрами от нуля до одной секунды ), при-
чем при уменьшении скорости до предела фильм  "застывает"  до  нажатия
клавиши  `+' или ESC.  Клавиша ESC может быть использована в любой мо-
мент для прерывания показа.

                                                              Спасибо.

                                      Василий Захаров, гр. 203 ( 217 )
						       
                                                    18 марта 1996 года
